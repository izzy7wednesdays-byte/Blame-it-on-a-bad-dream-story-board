<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Blame It On A Bad Dream — Horizontal Archive</title>
<style>
  /* ========= V111 ========= */
  /* ========= GLOBAL CONTROLS ========= */
  :root{
    /* Height scales with viewport height & a bit with width.
       If you prefer fixed-by-height only, use: --band-h: 70vh; */
    --band-h: clamp(56svh, 56vw, 84svh);

    /* Total width of the horizontal canvas (increase as you add slots) */
    --rail-w: 600svh;

    --bg: #0d161d;
    --fg: #e7f1ff;
  }

  *{ box-sizing:border-box }
  html,body{
    margin:0; height:100%;
    background:var(--bg); color:var(--fg);
    overflow:hidden;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }

  /* ========= HORIZONTAL SCROLLER ========= */
  .hwrap{
    height:100svh;
    overflow-x:auto; overflow-y:hidden;
    white-space:nowrap;
    scroll-behavior:smooth;
    scrollbar-width:thin;
  }
  .hwrap::-webkit-scrollbar{ height:8px }
  .hwrap::-webkit-scrollbar-thumb{ background:#2c2c32; border-radius:8px }

  /* ========= RAIL (ABSOLUTE LAYOUT + GROUP NUDGE) ========= */
  .rail{
    position: relative;
    height: var(--band-h);
    width: max(100%, var(--rail-w));
    padding: 0;            /* let the first slot hug the left */
    --group-left: -25svh;  /* ← move whole collage left/right here */
  }

  /* ========= SLOT CONTROL PANEL ========= */
  .slot{
    --left: 0svh;
    --scale: 1;
    --y: 0svh;
    --x: 0svh;
    --rot: 0deg;
    --z: 1;

    position: absolute;
    left: calc(var(--left) + var(--group-left));
    bottom: 0;
    display: flex; align-items: flex-end;
    height: var(--band-h);
    transform: translate(var(--x), calc(-1 * var(--y))) rotate(var(--rot));
    transform-origin: center bottom;
    z-index: var(--z);
    color: inherit; text-decoration: none;
  }

  /* Images scale with band height *and* per-slot --scale */
  .slot img{
    height: calc(var(--band-h) * var(--scale));
    width: auto;
    display: block;
    object-fit: contain;
    filter: drop-shadow(0 .6vh 1.2vh rgba(0,0,0,.5));
  }

  /* Spotify slot */
  .slot--spotify .sp-box{
    --sp-shrink: 0.675;
    --sp-ratio: 0.889;
    --sp-min: 220px;
    --sp-max: 520px;
    --h: calc(var(--band-h) * var(--scale) * var(--sp-shrink));
    width: clamp(var(--sp-min), calc(var(--h) * var(--sp-ratio)), var(--sp-max));
    height: var(--h);
    display:block;
    overflow:hidden;
    border-radius:12px;
    filter: drop-shadow(0 .6vh 1.2vh rgba(0,0,0,.5));
    background:#121212;
  }
  .slot--spotify iframe{ width:100%; height:100%; border:0; border-radius:12px; }
  #playlist-ex .sp-box{
    height: auto;
    aspect-ratio: 685 / 302; /* ≈ 2.268:1 */
  }

  /* YouTube slot */
  .slot--youtube .yt-box{
    --yt-shrink: 0.85;
    --ratio: 16/9;
    --h: calc(var(--band-h) * var(--scale) * var(--yt-shrink));
    width: clamp(300px, calc(var(--h) * var(--ratio)), 960px);
    height: var(--h);
    display:block;
    overflow:hidden;
    border-radius:12px;
    filter: drop-shadow(0 .6vh 1.2vh rgba(0,0,0,.5));
    background:#000;
  }
  .slot--youtube iframe{ width:100%; height:100%; border:0; border-radius:12px; }

  /* Lottie slot */
  .slot--lottie .lot-box{
    --lot-shrink: 0.85;
    --ratio: 1.8;
    --lot-min: 220px;
    --lot-max: 960px;
    --h: calc(var(--band-h) * var(--scale) * var(--lot-shrink));
    width: clamp(var(--lot-min), calc(var(--h) * var(--ratio)), var(--lot-max));
    height: var(--h);
    display:block;
    overflow:hidden;
    border-radius:12px;
    filter: drop-shadow(0 .6vh 1.2vh rgba(0,0,0,.5));
    background: transparent;
  }
  .slot--lottie dotlottie-wc{
    width:100%;
    height:100%;
    display:block;
  }

  /* === Video slot (Vimeo iframe) === */
  .slot--video .video-box{
    --h: calc(var(--band-h) * var(--scale));
    height: var(--h);
    width: calc(var(--h) * var(--ar, 16/9));
    display: block;
    overflow: hidden;
    border-radius: 12px;
    filter: drop-shadow(0 .6vh 1.2vh rgba(0,0,0,.5));
    background: #000;
  }
  .slot--video iframe{ width: 100%; height: 100%; display:block; border:0; }

  /* === Gif Slot === */
  .slot--gif .gif-box{
    --h: calc(var(--band-h) * var(--scale));
    height: var(--h);
    width: calc(var(--h) * var(--ar, 1));
    display:block;
    overflow:hidden;
    border-radius:12px;
    filter: drop-shadow(0 .6vh 1.2vh rgba(0,0,0,.5));
    background:#0000;
  }
  .slot--gif img{ width:100%; height:100%; object-fit:cover; display:block; }

  /* SoundCloud image-controlled slot */
  .slot--sc .sc-iframe{
    position:absolute;
    left:-9999px; top:auto; width:1px; height:1px; opacity:0; pointer-events:none;
    border:0;
  }
  .slot--sc .sc-trigger{
    height: calc(var(--band-h) * var(--scale));
    width: auto; display:block; object-fit: contain;
    filter: drop-shadow(0 .6vh 1.2vh rgba(0,0,0,.5));
    cursor: pointer;
  }

  /* === Audio (image-controlled .mp4/.mp3) === */
  .slot--audio .audio-trigger{
    height: calc(var(--band-h) * var(--scale));
    width: auto; display:block; object-fit: contain;
    filter: drop-shadow(0 .6vh 1.2vh rgba(0,0,0,.5));
    cursor: pointer; user-select: none;
  }
  .slot--audio audio{
    position:absolute; left:-9999px; top:auto;
    width:1px; height:1px; opacity:0; pointer-events:none; border:0;
  }
  .slot--audio.is-playing .audio-trigger{
    outline: 2px dashed;
    outline-color: #4C58E9;
    outline-offset: 6px;
  }

  /* ========= PER-SLOT CUSTOMIZATION ========= */
  #special-message{ 
      --left: -48svh; 
      --scale: 1.95; 
      --y: -31svh; 
      --x: 0svh; 
      --rot: 0deg; 
      --z: 5;
  }
  #scribble-izzy{ 
      --left: 10svh; 
      --scale: 0.25; 
      --y: 38svh; 
      --x: 8svh; 
      --rot: 0deg; 
      --z: 4; 
  }
  #torn-note{ 
      --left: 12svh; 
      --scale: 0.83; 
      --y: -25svh; 
      --x: -2svh; 
      --rot: 0deg; 
      --z: 3; 
  }
  #tracklist{ 
      --left: 130svh; 
      --scale: 0.55; 
      --y: 35svh; 
      --x: 15svh; 
      --rot: 8deg; 
      --z: 4; 
  }
  #the-story-behind{ 
      --left: 70svh; 
      --scale: 0.15; 
      --y: 20svh; 
      --x: 0svh; 
      --rot: 0deg; 
      --z: 2; 
  }
  #album-title{ 
      --left: 80svh; 
      --scale: 0.33; 
      --y: -8svh; 
      --x: -6svh; 
      --rot: 0deg; 
      --z: 1; 
  }
  #playlist-ex{ 
      --left: 203svh; 
      --scale: 0.90; 
      --y: 55svh; 
      --x: 0svh; 
      --rot: 0deg; 
      --z: 2; 
  }
  #light-sleeper-visualizer{ 
      --left: 167svh; 
      --scale: 0.50; 
      --y: -12svh; 
      --x: 10svh; 
      --rot: 0deg; 
      --z: 3; 
  }
  #light-sleeper-title{ 
      --left: 205svh; 
      --scale: 0.34; 
      --y: 25svh; 
      --x: -4svh; 
      --rot: 0deg; 
      --z: 4; 
  }
  #pink-flashing-arrow{ 
      --left: 155svh; 
      --scale: 0.08; 
      --y: -5svh; 
      --x: 0svh; 
      --rot: 0deg; 
      --z: 5; 
  }
  #light-sleeper-studio{ 
      --left: 293svh; 
      --scale: 0.60; 
      --ar: 9/16; 
      --y: 30svh; 
      --x: 0svh; 
      --rot: 0deg; 
      --z: 4; 
  }
  #tv-message-1{ 
      --left: 255svh; 
      --scale: 0.47; 
      --y: 40svh; 
      --x: 0svh; 
      --rot: -10deg; 
      --z: 4; 
  }
  #autumn-text{ 
      --left: 253svh; 
      --scale: 0.33; 
      --y: 9svh; 
      --x: 0svh; 
      --rot: 2deg; 
      --z: 0; 
  }
  #blame-it-notesapp{ 
      --left: 250svh; 
      --scale: 0.25; 
      --y: -14svh; 
      --x: 0svh; 
      --rot: -2deg; 
      --z: 4; 
  }
  #broken-breathing-placeholder{ 
      --left: 300svh; 
      --scale: 0.4; 
      --y: -10svh; 
      --x: 1svh; 
      --rot: 0deg; 
      --z: 3; 
  }
  #ls-behind-the-song-placeholder{ 
      --left: 330svh; 
      --scale: 0.4; 
      --y: 40svh;
      --x: 0svh; 
      --rot: 0deg; 
      --z: 1; 
  }
  #exit-wounds-title{ 
      --left: 368svh; 
      --scale: 0.44; 
      --y: -10svh; 
      --x: 0svh; 
      --rot: -14deg; 
      --z: 1;
      pointer-events: none;
  }
  #play-exit-wounds{ 
      --left: 402svh; 
      --scale: 0.55; 
      --y: 40svh; 
      --x: 0svh; 
      --rot: -12deg; 
      --z: 6; 
  }
  #press-play-dj{ 
      --left: 408svh; 
      --scale: 0.15; 
      --y: 39svh; 
      --x: 0svh; 
      --rot: 0deg; 
      --z: 1;
      pointer-events: none;
  }
  #link-exit-wounds-substack{ 
      --left: 512svh; 
      --scale: 0.90; 
      --y: 6svh; 
      --x: 0svh; 
      --rot: 15deg; 
      --z: 4; 
  }
  #substack-point-arrow{ 
      --left: 486svh; 
      --scale: 0.38; 
      --y: 18svh; 
      --x: 0svh; 
      --rot: 12deg; 
      --z: 4;
      pointer-events: none;
  }
    #read-exitwounds{ 
      --left: 486svh; 
      --scale: 0.38; 
      --y: 18svh; 
      --x: 0svh; 
      --rot: 12deg; 
      --z: 4;
      pointer-events: none;
  }
  #play-exit-wounds-voicememo{
    --left: 443svh;
    --scale: 0.28;
    --y: -15svh;
    --x: 0svh;
    --rot: 0deg;
    --z: 7;
  }
  #exit-wounds-clickme{
    --left: 465svh;
    --scale: 0.07;
    --y: -5svh;
    --x: 0svh;
    --rot: 0deg;
    --z: 7;
    pointer-events: none;
  }
</style>

<!-- Lottie web component -->
<script type="module" src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.6.2/dist/dotlottie-wc.js"></script>
</head>
<body>

<div class="hwrap" id="hwrap">
  <div class="rail">

    <!-- 1 -->
    <figure class="slot" id="special-message">
      <img
        src="https://raw.githubusercontent.com/izzy7wednesdays-byte/Blame-it-on-a-bad-dream-story-board/refs/heads/main/img/headline-special-message.png"
        alt="A SPECIAL MESSAGE FROM…" />
    </figure>

    <!-- 2 -->
    <figure class="slot" id="scribble-izzy">
      <img
        src="https://raw.githubusercontent.com/izzy7wednesdays-byte/Blame-it-on-a-bad-dream-story-board/refs/heads/main/img/scribble-izzy.png"
        alt="Izzy MacArthur" />
    </figure>

    <!-- 3 -->
    <figure class="slot" id="torn-note">
      <img
        src="https://raw.githubusercontent.com/izzy7wednesdays-byte/Blame-it-on-a-bad-dream-story-board/refs/heads/main/img/torn-note.png"
        alt="Note from Izzy" />
    </figure>

    <!-- 4 -->
    <figure class="slot" id="tracklist">
      <img
        src="https://raw.githubusercontent.com/izzy7wednesdays-byte/Blame-it-on-a-bad-dream-story-board/refs/heads/main/img/tracklist.png"
        alt="Tracklist" />
    </figure>

    <!-- 5 -->
    <figure class="slot" id="the-story-behind">
      <img
        src="https://raw.githubusercontent.com/izzy7wednesdays-byte/Blame-it-on-a-bad-dream-story-board/refs/heads/main/img/the-story-behind.png"
        alt="THE STORY BEHIND:" />
    </figure>

    <!-- 6 -->
    <figure class="slot" id="album-title">
      <img
        src="https://raw.githubusercontent.com/izzy7wednesdays-byte/Blame-it-on-a-bad-dream-story-board/refs/heads/main/img/blame-it-on-a-bad-dream.png"
        alt="BLAME IT ON A BAD DREAM" />
    </figure>

    <!-- 7: Spotify playlist -->
    <figure class="slot slot--spotify" id="playlist-ex">
      <div class="sp-box">
        <iframe data-testid="embed-iframe" style="border-radius:12px"
          src="https://open.spotify.com/embed/playlist/07REAl6PPjOz2fLhehn0Xr?utm_source=generator"
          width="100%" height="352" frameborder="0" allowfullscreen
          allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
          loading="lazy" title="Spotify playlist">
        </iframe>
      </div>
    </figure>

    <!-- 8: YouTube – Light Sleeper Visualizer -->
    <figure class="slot slot--youtube" id="light-sleeper-visualizer">
      <div class="yt-box">
        <iframe
          src="https://www.youtube.com/embed/Hvy3xS_jpAM?rel=0&modestbranding=1&playsinline=1"
          title="Light Sleeper – Visualizer"
          loading="lazy"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          allowfullscreen>
        </iframe>
      </div>
    </figure>

    <!-- 9: Lottie — Light Sleeper Title -->
    <figure class="slot slot--lottie" id="light-sleeper-title">
      <div class="lot-box">
        <dotlottie-wc
          src="Lottie/light-sleeper-title.lottie"
          autoplay
          loop
          speed="2"
          style="width:100%;height:100%">
        </dotlottie-wc>
      </div>
    </figure>

    <!-- 10: Lottie — Pink Flashing Arrow -->
    <figure class="slot slot--lottie" id="pink-flashing-arrow">
      <div class="lot-box">
        <dotlottie-wc
          src="Lottie/pink-flashing-arrow.lottie"
          autoplay
          loop
          speed="1"
          style="width:100%;height:100%">
         </dotlottie-wc>
      </div>
    </figure>

    <!-- 11: Vimeo (portrait 1080×1920) - Light Sleeper -->
    <figure class="slot slot--video" id="light-sleeper-studio">
      <div class="video-box">
        <iframe
          src="https://player.vimeo.com/video/1114381114?title=0&byline=0&portrait=0&dnt=1&transparent=0&playsinline=1"
          loading="lazy"
          allow="autoplay; encrypted-media; fullscreen; picture-in-picture"
          allowfullscreen
          title="Light Sleeper Studio">
        </iframe>
      </div>
    </figure>

    <!-- 12: GIF slot -->
    <figure class="slot" id="tv-message-1">
      <img src="img/tv-message-1.gif?v=1" alt="TV message" loading="lazy" decoding="async">
    </figure>

    <!-- 13: AUTUMN TEXT -->
    <figure class="slot" id="autumn-text">
      <img src="img/autumn-text.png?v=1" alt="Autumn text" loading="lazy" decoding="async">
    </figure>

    <!-- 15: BLAME IT Notes App -->
    <figure class="slot" id="blame-it-notesapp">
      <img src="img/blame-it-notesapp.png?v=1" alt="Blame It notes app" loading="lazy" decoding="async">
    </figure>

    <!-- 16: Broken Breathing (placeholder) -->
    <figure class="slot" id="broken-breathing-placeholder">
      <img src="img/broken-breathing-placeholder.png?v=1" alt="Broken Breathing placeholder" loading="lazy" decoding="async">
    </figure>

    <!-- 17: LS – Behind the Song (placeholder) -->
    <figure class="slot" id="ls-behind-the-song-placeholder">
      <img src="img/ls-behind-the-song-placeholder.png?v=1" alt="Light Sleeper - Behind the Song placeholder" loading="lazy" decoding="async">
    </figure>

    <!-- 18: Exit Wounds Title  -->
    <figure class="slot" id="exit-wounds-title">
      <img src="img/exit-wounds-title.png?v=1" alt="Exit Wounds Title" loading="lazy" decoding="async">
    </figure>

    <!-- 19: SOUND (SoundCloud) — click image to play/pause -->
    <figure class="slot slot--sc" id="play-exit-wounds"
            data-sc-url="https://soundcloud.com/izzy-macarthur/exit-wounds">
      <img class="sc-trigger"
           src="img/exit-wounds-boombox.png"
           alt="Play Exit Wounds (SoundCloud)">
      <iframe class="sc-iframe" title="SoundCloud player" allow="autoplay"></iframe>
    </figure>

    <!-- 19: Press Play -->
    <figure class="slot" id="press-play-dj">
      <img src="img/press-play-dj.png?v=1" alt="press play dj" loading="lazy" decoding="async">
    </figure>
    
    <!-- 20: Exit Wounds Voicememo -->
      <figure class="slot slot--audio" id="play-exit-wounds-voicememo"
          data-audio-src="audio/exit-wounds-voicememo.m4a" data-loop="false">
        <img class="audio-trigger"
           src="img/exit-wounds-voicememo.png"
           alt="Play Exit Wounds Voice Memo">
      <audio preload="auto" playsinline>
        <!-- Prefer an mp3/m4a if you have one; otherwise leave just the mp4 -->
        <!-- <source src="audio/exit-wounds-voicememo.mp3" type="audio/mpeg"> -->
        <!-- <source src="audio/exit-wounds-voicememo.m4a" type="audio/mp4"> -->
        <source src="audio/exit-wounds-voicememo.m4a" type="audio/mp4">
      </audio>
    </figure>

    <!-- 21: Exit Wounds Substack Flier -->
    <figure class="slot" id="link-exit-wounds-substack">
      <a href="https://izzymacarthur.substack.com/p/with-no-exit-wounds"
         target="_blank" rel="noopener noreferrer">
        <img src="img/exit-wounds-substack-flier.png?v=1"
             alt="With No Exit Wounds — read on Substack">
      </a>
    </figure>

    <!-- 22: Arrow Pointing to Exit Wounds Flier -->
    <figure class="slot" id="substack-point-arrow">
      <img src="img/substack-point-arrow.png?v=1" alt="substack point arrow" loading="lazy" decoding="async">
    </figure>
    
    <!-- 23: Arrow Pointing to Exit Wounds Flier -->
    <figure class="slot" id="read-exitwounds">
      <img src="img/read-exitwounds.png?v=1" alt="read exit wounds" loading="lazy" decoding="async">
    </figure>

    <!-- 24: Exit Wounds Click Me -->
    <figure class="slot" id="exit-wounds-clickme">
      <img src="img/exit-wounds-clickme.png?v=1" alt="exit wounds click me" loading="lazy" decoding="async">
    </figure>
    
    <!-- Add more slots here… -->
  </div>
</div>

<script>
  /* Mouse wheel → horizontal scroll (desktop mice) */
  const wrap = document.getElementById('hwrap');
  wrap.addEventListener('wheel', (e) => {
    if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {
      wrap.scrollLeft += e.deltaY;
      e.preventDefault();
    }
  }, { passive: false });
</script>

<!-- SoundCloud API -->
<script src="https://w.soundcloud.com/player/api.js"></script>

<!-- SoundCloud initializer (READY-safe + pointer events + cross-pause) -->
<script>
(() => {
  function initSoundCloud() {
    window.__scWidgets = [];

    document.querySelectorAll('.slot--sc').forEach((slot) => {
      const scUrl   = (slot.dataset.scUrl || '').trim();
      const iframe  = slot.querySelector('.sc-iframe');
      const trigger = slot.querySelector('.sc-trigger');
      if (!scUrl || !iframe || !trigger) return;

      const embed = 'https://w.soundcloud.com/player/?url=' +
        encodeURIComponent(scUrl) +
        '&auto_play=false&hide_related=true&show_comments=false&show_user=false' +
        '&show_reposts=false&visual=false';
      iframe.src = embed;

      const widget = SC.Widget(iframe);
      window.__scWidgets.push(widget);

      let ready = false;
      widget.bind(SC.Widget.Events.READY, () => { ready = true; });

      const setPlaying = (on) => slot.classList.toggle('is-playing', !!on);
      widget.bind(SC.Widget.Events.PLAY, () => {
        setPlaying(true);
        // Pause any HTML <audio> voice-memos
        document.querySelectorAll('.slot--audio audio').forEach(a => a.pause());
      });
      const notPlaying = () => setPlaying(false);
      widget.bind(SC.Widget.Events.PAUSE,  notPlaying);
      widget.bind(SC.Widget.Events.FINISH, notPlaying);

      const toggle = () => {
        if (!ready) {
          widget.bind(SC.Widget.Events.READY, () => widget.isPaused(p => p ? widget.play() : widget.pause()));
          return;
        }
        widget.isPaused(p => p ? widget.play() : widget.pause());
      };

      if (window.PointerEvent) {
        trigger.addEventListener('pointerup', (e) => {
          e.preventDefault(); e.stopPropagation();
          toggle();
        }, { passive: false });
      } else {
        let ignoreNextClick = false;
        trigger.addEventListener('touchend', (e) => {
          e.preventDefault(); e.stopPropagation();
          ignoreNextClick = true; setTimeout(() => ignoreNextClick = false, 400);
          toggle();
        }, { passive: false });
        trigger.addEventListener('click', (e) => {
          if (ignoreNextClick) { e.preventDefault(); return; }
          e.preventDefault(); e.stopPropagation();
          toggle();
        }, { passive: false });
      }
    });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initSoundCloud);
  } else {
    initSoundCloud();
  }
})();
</script>

  <!-- Audio-Image initializer  -->
<script>
(() => {
  function initImageAudio(){
    document.querySelectorAll('.slot--audio').forEach((slot) => {
      const audio   = slot.querySelector('audio');
      const trigger = slot.querySelector('.audio-trigger');
      if (!audio || !trigger) return;

      // If a data-audio-src is given, prefer it (works even without <source>)
      const srcAttr = (slot.dataset.audioSrc || '').trim();
      if (srcAttr) audio.src = srcAttr;

      // Ensure <source> tags (if any) are registered before first play
      audio.load();

      audio.loop = (slot.dataset.loop === 'true');
      audio.preload = 'auto';
      audio.setAttribute('playsinline', '');

      const updateUI = () => {
        const playing = !audio.paused && !audio.ended;
        slot.classList.toggle('is-playing', playing);
        trigger.setAttribute('aria-pressed', playing ? 'true' : 'false');
      };

      audio.addEventListener('play', () => {
        // Pause other HTML <audio> players
        document.querySelectorAll('.slot--audio audio').forEach((a) => { if (a !== audio) a.pause(); });
        // Pause SoundCloud if it’s playing
        if (window.__scWidgets && Array.isArray(window.__scWidgets)) {
          window.__scWidgets.forEach(w => { try { w.pause(); } catch(e){} });
        }
        updateUI();
      });
      audio.addEventListener('pause', updateUI);
      audio.addEventListener('ended', updateUI);

      const toggle = () => {
        if (audio.paused || audio.ended) {
          const p = audio.play();
          if (p && typeof p.catch === 'function') {
            p.catch((e) => {
              console.warn('[VoiceMemo] play() failed. src:', audio.currentSrc || srcAttr, e);
            });
          }
        } else {
          audio.pause();
        }
      };

      // Use pointer events to avoid touch+click double-fire
      if (window.PointerEvent) {
        trigger.addEventListener('pointerup', (e) => { e.preventDefault(); e.stopPropagation(); toggle(); }, { passive: false });
      } else {
        trigger.addEventListener('click', (e) => { e.preventDefault(); e.stopPropagation(); toggle(); }, { passive: false });
        trigger.addEventListener('touchend', () => toggle(), { passive: true });
      }

      audio.addEventListener('error', () => {
        const err = audio.error;
        console.warn('[VoiceMemo] <audio> error', {
          code: err && err.code, // 1 aborted, 2 network, 3 decode, 4 src unsupported
          currentSrc: audio.currentSrc || srcAttr
        });
      });

      updateUI();
    });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initImageAudio);
  } else {
    initImageAudio();
  }
})();
</script>

</body>
</html>
